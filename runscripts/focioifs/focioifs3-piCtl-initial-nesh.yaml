# example to use the max number of nodes / CPUs that 
# currently work on nesh with intel2020 and intelmpi
# even with openMPI we weren't able to use more nodes
# Karsten Balzer from hpcsupport is currently investigating
# on JUWELS increasing the number of CPUs for OpenIFS and NEMO
# will work
general:
   use_venv: False
   verbose: False 
   homedir: !ENV ${HOME}
   workdir: !ENV ${WORK}
   
   setup_name: "focioifs"      
   resolution: "TCO95_ORCA05"

   compute_time: "01:00:00"
   initial_date: "1850-01-01T00:00:00"       # Initial exp. date
   final_date: "1850-02-01T00:00:00"         # Final date of the experiment

   nyear: 0
   nmonth: 1
   nday: 0
   hours: 0
  
   # we dont need compute budgets on NESH
   #account: shk00018
   base_dir: ${workdir}/esm-slask/

computer:
   additional_flags:
      - --mem=72000
      #- --constraint=cascade 

focioifs:
   model_dir: /gxfs_work/geomar/smomw352/models_oneapi/focioifs-3.0
  
oifs:
   version: "43r3"
   with_xios: True
   scenario: "piControl"
   mip: "cmip6"
   pool_dir: "/gxfs_work/geomar/smomw352/foci_input2/"
   input_dir: "${pool_dir}/openifs_cy43_tco95/"
   rtables_dir: "${pool_dir}/openifs_cy43_general/rtables/"
   vtables_dir: "${pool_dir}/openifs_cy43_general/vtables/"
   clim_dir: "${pool_dir}/openifs_cy43_tco95/95_4/"
   ifsdata_dir: "${pool_dir}/openifs_cy43_general/ifsdata/"
   cmip6_data_dir: "${pool_dir}/openifs_cy43_general/cmip6-data/"
   icmcl_dir: "${pool_dir}/openifs_cy43_tco95/2008010100/"
   icmcl_file: "ICMCLhagwINIT"
   prepifs_expid: hagw
   prepifs_startdate: 20080101
   resolution: TCO95
   levels: L91
   lresume: 0
   nproc: 144
   use_ocean_currents: 0
   perturb: 0
   sclct_switch: 2

   # control some tunable parameters
   # ENTRORG default: 1.75E-3
   #namelist_changes:
   #   fort.4:
   #      NAMCUMF:
   #         #RPRCON: 1.0E-3
   #         ENTRORG: 1.85E-3 # increase to cool globally
   #      NAMCLDP:
   #         RVICE: 0.15 # increase to cool globally
   #      NAMGFL:
   #         NMFDIAGLEV: 2  # turn on to diagnose mass fixers

oasis3mct:
   norestart: F
   use_lucia: True
   #export_mode: EXPOUT
   #debug_level: 50
   pool_dir: "/gxfs_work/geomar/smomw352/foci_input2/oasis3_openifs43r3-tco95_orca05/"
   ini_parent_dir: "/gxfs_work/geomar/smomw352/foci_input2/oasis3_openifs43r3-tco95_orca05/"
   oasis_date_stamp: "" 
   
nemo:
   resolution: "ORCA05"
   jpni: 16
   jpnj: 16
   nproc: 256
   input_dir: "/gxfs_work/geomar/smomw352/foci_input2/nemo_orca05/input/ORCA05/"
   
   add_namelist_changes:
       namelist_cfg:
           #namtra_ldf:
           #    rn_aht_0: 599
           namsbc_rnf:
               rn_rfact: 0.987
   
rnfmap:
   nproc: 1

xios: 
   with_model: focioifs 
   #xml_dir: "${oifs.pool_dir}/OASIS3_OPENIFS43R3-TCO95_ORCA05/output_3h+6hrLev_5dUVTS"
   xml_dir: "/gxfs_work/geomar/smomw352/foci_input2/oasis3_openifs43r3-tco95_orca05/output_for_spinup/"
   nproc: 4
